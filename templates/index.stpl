<!DOCTYPE html>
<html>
    <% include!("head.stpl"); %>
    <body>
        <header>
            <nav>
                <h1><a href="/">Bookmarks <%= number %></a></h1>
                <% include!("nav.stpl"); %>
            </nav>
        </header>
        <main>
            <% for bookmark in bookmarks { %>
                <article>
                    <div class="bookmark">
                        <h3><a href="<%- bookmark.url %>"><%- bookmark.name %></a></h3>

                        <a class="edit-bookmark-btn emoji" href="/edit-bookmark/<%= bookmark.id %>">‚úèÔ∏è</a>
                        <a class="delete-bookmark-btn emoji" href="/delete-bookmark/<%= bookmark.id %>">üóëÔ∏è</a>
                    </div>
                    <% if !bookmark.description.is_empty() { %>
                        <div class="description"> <%- bookmark.description %> </div>
                    <% } %>
                    <div class="about-bookmark">
                        <div>
                            <% for tag in bookmark.tags { %>
                                <a href="/tags/<%= tag %>">#<%= tag %></a>
                            <% } %>
                        </div>

                        <% use time::{OffsetDateTime, macros::format_description, UtcOffset}; %>
                        <time><%= OffsetDateTime::from_unix_timestamp(bookmark.creation_time).unwrap().to_offset(UtcOffset::current_local_offset().unwrap()).format(format_description!("[year]-[month]-[day] [hour]:[minute]")).unwrap().to_string() %></time>
                    </div>
                </article>
            <% } %>
            <% if pages > 1 { %>
                <div class="pages">
                    <% for i in 0.max(pg-5)..pages.min(pg+6) { %>
                        <a href="/all?p=<%= i %>"><%= i+1 %></a>
                    <% } %>
                    <% if pages > 5 && pg < pages - 6 { %><span>...</span><% } %>
                    <form action="/all" id="page-selection">
                        <select name="p" form="page-selection" onchange="this.form.submit();">
                            <% for i in 0..pages { %>
                                <option value="<%= i %>" <%= if pg == i { "selected" } else { "" } %> > <%= i+1 %> </option>
                            <% } %>
                        </select>
                    </form>
                </div>
            <% } %>
        </main>
        <div class="right-bar">
            <details>
                <summary>Add bookmarks</summary>
                <summary>Add bookmarks from file</summary>
                <form method="POST" enctype="multipart/form-data">
                    <input type="file" name="file" multiple />
                    <button class="btn">Save</button>
                </form>
                <hr>
                <form method="POST" action="/add-urls">
                    <textarea name="urls" placeholder="Insert bookmarks in format:&#10;name &#10;url"></textarea>
                    <button class="btn">Save</button>
                </form>
            </details>
            <form action="/search">
                <input type="date" class="choose-date" name="d" onchange="this.form.submit();">
            </form>
        </div>
    </body>
</html>